---
import Logo from './Logo.astro';
import Button from './Button.astro';

interface Props {
  actions?: { label: string; href: string; variant?: 'primary' | 'secondary' | 'outline' | 'ghost' }[];
  navItems?: { label: string; href: string }[];
  siteName?: string;
}

const { 
  actions = [], 
  navItems = [],
  siteName
} = Astro.props;
---

<header class="fixed top-0 w-full z-50 bg-stone-50/90 backdrop-blur-md border-b border-stone-200 transition-all duration-300" id="main-header">
  <div class="container h-16 flex items-center justify-between">
    <!-- Logo -->
    <a href="/" class="flex items-center gap-2 group" aria-label="Go to homepage">
      <Logo height={32} class="text-stone-900 group-hover:text-teal-800 transition-colors" />
      {siteName && (
        <span class="hidden md:inline-block font-display font-bold text-lg text-stone-500 pl-4 border-l border-stone-300 ml-4">
          {siteName}
        </span>
      )}
    </a>

    <!-- Desktop Nav -->
    <nav class="hidden md:flex items-center gap-8">
      {navItems.map(item => (
        <a 
          href={item.href} 
          class="text-stone-600 hover:text-teal-700 font-medium text-sm transition-colors"
        >
          {item.label}
        </a>
      ))}
    </nav>

    <!-- Desktop Actions -->
    <div class="hidden md:flex items-center gap-4">
      {actions.map(action => (
        <Button href={action.href} variant={action.variant || 'primary'} size="sm">
          {action.label}
        </Button>
      ))}
    </div>

    <!-- Mobile Menu Button -->
    <button 
      id="mobile-menu-btn"
      class="md:hidden p-2 text-stone-600 hover:bg-stone-100 rounded-lg"
      aria-label="Toggle menu"
      aria-expanded="false"
    >
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6">
        <line x1="3" y1="12" x2="21" y2="12"></line>
        <line x1="3" y1="6" x2="21" y2="6"></line>
        <line x1="3" y1="18" x2="21" y2="18"></line>
      </svg>
    </button>
  </div>

  <!-- Mobile Menu Overlay -->
  <div 
    id="mobile-menu" 
    class="fixed inset-0 top-16 bg-stone-50 z-40 transform translate-x-full transition-transform duration-300 md:hidden flex flex-col p-6 gap-6 overflow-y-auto border-t border-stone-200"
  >
    <nav class="flex flex-col gap-4">
      {navItems.map(item => (
        <a 
          href={item.href} 
          class="text-stone-900 text-lg font-medium py-2 border-b border-stone-100"
        >
          {item.label}
        </a>
      ))}
    </nav>
    <div class="flex flex-col gap-4 mt-4">
      {actions.map(action => (
        <Button href={action.href} variant={action.variant || 'primary'} size="lg" class="w-full">
          {action.label}
        </Button>
      ))}
    </div>
  </div>
</header>

<script>
  const btn = document.getElementById('mobile-menu-btn');
  const menu = document.getElementById('mobile-menu');
  const header = document.getElementById('main-header');
  let isOpen = false;

  if (btn && menu) {
    btn.addEventListener('click', () => {
      isOpen = !isOpen;
      btn.setAttribute('aria-expanded', String(isOpen));
      
      if (isOpen) {
        menu.classList.remove('translate-x-full');
        // Change icon to X
        btn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>`;
      } else {
        menu.classList.add('translate-x-full');
        // Change icon back to hamburger
        btn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>`;
      }
    });
  }

  // Scroll effect for header
  window.addEventListener('scroll', () => {
    if (window.scrollY > 10) {
      header?.classList.add('shadow-md');
    } else {
      header?.classList.remove('shadow-md');
    }
  });
</script>